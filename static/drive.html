<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drive</title>
    <link rel="stylesheet" href="drive.css">
</head>
<body>
    <div id="loading-screen">
        <div class="prompt-container">
            <input type="text" class="prompt-input" id="prompt" placeholder="Enter your prompt..." autofocus>
            <span class="enter-hint">ENTER</span>
        </div>

        <div class="input-wrapper-drive">
            <button class="input-icon">+</button>
            <input type="text" class="prompt-input-imessage" id="prompt-imessage" placeholder="Enter your prompt..." autofocus>
            <span class="enter-hint">ENTER</span>
        </div>

        <div class="sampling-toggle-container">
            <div class="toggle-switch" id="sampling-toggle" onclick="toggleSamplingMethod()">
                <div class="toggle-slider"></div>
                <span class="toggle-option left">Top-K</span>
                <span class="toggle-option right">Top-P</span>
            </div>
            <div class="sampling-param-box">
                <span class="param-prefix" id="param-prefix">k=</span>
                <input type="text" class="param-input" id="param-input" value="5">
            </div>
        </div>

        <div class="controls" style="display: none;">
            <div>
                <div class="control-label">K (branches)</div>
                <input type="number" class="control-input" id="k-value" min="1" max="20" value="3">
            </div>
            <div style="display: none;">
                <div class="control-label">N (depth)</div>
                <input type="number" class="control-input" id="n-value" min="1" max="10" value="4">
            </div>
        </div>

        <div id="error-container"></div>
    </div>

    <div id="game-container">
        <div class="title">MikeRL</div>

        <div class="rl-method-toggle" id="rl-method-toggle">
            <button class="rl-method-btn active" id="dpo-btn" onclick="setRLMethod('dpo')">DPO</button>
            <button class="rl-method-btn" id="grpo-btn" onclick="setRLMethod('grpo')">GRPO</button>
        </div>

        <div class="token-explorer" id="token-explorer">
        <div class="path-display" id="path-display">
            <div class="depth-section">
                <div class="depth-label">Depth</div>
                <div class="depth-value" id="depth-value">0</div>
            </div>
            <div class="path-section">
                <div class="path-title">Current Path</div>
                <div class="path-text" id="path-text"></div>
            </div>
        </div>

        <div id="levels-container"></div>

        <div class="controls-overlay">
            <div class="control-hint">
                <span class="key">←</span>
                <span class="key">→</span>
                <span>Navigate options</span>
            </div>
            <div class="control-hint">
                <span class="key">SPACE</span>
                <span>Select and go deeper</span>
            </div>
            <div class="control-hint">
                <span class="key">BACKSPACE</span>
                <span>Go back</span>
            </div>
            <div class="control-hint">
                <span class="key">G</span>
                <span>Mark path as Good</span>
            </div>
            <div class="control-hint">
                <span class="key">B</span>
                <span>Mark path as Bad</span>
            </div>
            <div class="control-hint">
                <span class="key">E</span>
                <span>Export selections</span>
            </div>
        </div>

        <div class="selections-panel" id="selections-panel">
            <div class="panel-title">Selected Paths</div>
            <div class="selections-list" id="selections-list">
                <div class="selection-placeholder">No positive example selected</div>
                <div class="selection-placeholder">No negative example selected</div>
            </div>
            <div class="execute-hint" id="execute-hint">
                <span class="key">E</span>
                <span>Execute training</span>
            </div>
            <div class="history-header" id="history-header" style="display: none;">
                <div class="history-title">Training History</div>
                <div class="dropdown-arrow" id="dropdown-arrow">◀</div>
            </div>
            <div class="history-list" id="history-list"></div>
        </div>
        </div>

        <div class="ranking-view" id="ranking-view">
            <div class="grpo-container">
                <div class="grpo-prompt-column">
                    <div class="grpo-prompt-label">Prompt</div>
                    <div class="grpo-prompt-text" id="grpo-prompt-text"></div>
                </div>
                <div class="grpo-responses-column" id="grpo-responses">
                    <!-- 8 response rows generated dynamically -->
                </div>
            </div>
            <div class="grpo-instructions" id="grpo-instructions">
                <span>Select options from best to worst</span>
                <span class="key">A</span>-<span class="key">H</span>
                <span class="key">BACKSPACE</span> undo
                <span class="key">ENTER</span> submit
            </div>
        </div>
    </div>

    <!-- JavaScript files loaded in dependency order -->
    <script src="js/drive-state.js"></script>
    <script src="js/drive-api.js"></script>
    <script src="js/drive-navigation.js"></script>
    <script src="js/drive-render.js"></script>
    <script src="js/drive-training.js"></script>
    <script src="js/drive-grpo.js"></script>
    <script src="js/drive-events.js"></script>
</body>
</html>
